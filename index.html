<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PinkPetal.store</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap');

:root{
  --bg1:#2d0f18;
  --bg2:#6d2b3a;
  --pink-1:#ffbfdc;
  --pink-2:#ff8abf;
  --pink-3:#ff3ca6;
  --card-bg: rgba(255,255,255,0.03);
}

/* Reset + base */
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: 'Poppins', Arial, sans-serif;
  background: linear-gradient(180deg, var(--bg1), var(--bg2));
  color: #ffd6ea;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  min-height: 100vh;
}

/* container */
.container {
  max-width: 980px;
  margin: 0 auto;
  padding: 20px 16px 80px;
}

/* === TOP BAR (NEW) === */
.topbar {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 22px;
  padding: 6px 10px;
  gap: 20px;
}

.brand {
  font-size: 32px;
  font-weight: 700;
  color: var(--pink-2);
  text-shadow: 0 6px 18px rgba(255,90,151,0.18);
  display:flex;
  align-items:center;
  gap:12px;
}

.divider {
  width: 1px;
  height: 44px;
  background: rgba(255,255,255,0.12);
  border-radius: 8px;
  margin-left: 18px;
}

/* right side controls */
.right-controls {
  display: flex;
  align-items: center;
  gap: 12px;
}

.small-btn {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 10px;
}

/* mini cart bubble */
.cart-mini {
  background: rgba(0,0,0,0.45);
  padding: 8px 14px;
  border-radius: 10px;
  font-weight: 600;
  color: #ffd6ea;
  border: 1px solid rgba(255,255,255,0.05);
  display:flex;
  align-items:center;
  gap:8px;
}

/* account buttons area (fallback) */
.account-row {
  display:flex;
  justify-content:center;
  gap:10px;
  margin-bottom:18px;
}

/* products grid */
.products {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap:22px;
  margin-bottom: 26px;
}

.product {
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding: 14px;
  border-radius: 14px;
  text-align:center;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: 0 12px 36px rgba(0,0,0,0.45);
  transition: transform .25s ease, box-shadow .25s ease;
}
.product:hover {
  transform: translateY(-6px);
  box-shadow: 0 22px 48px rgba(0,0,0,0.55);
}

.product img {
  width:100%;
  height:150px;
  object-fit:cover;
  border-radius:10px;
  margin-bottom:10px;
}

/* product text */
.product h3 { margin:6px 0 4px; color:#ffd6ea; font-size:1.05rem; }
.product p { margin:0 0 12px; color:#ffd6eacc; font-size:0.95rem; }

/* buttons */
.btn {
  display:inline-block;
  padding:10px 14px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  color:#fff;
  font-weight:700;
  background: linear-gradient(90deg, var(--pink-2), var(--pink-3));
  box-shadow: 0 10px 26px rgba(255,60,166,0.12);
  transition: transform .15s ease, box-shadow .15s ease;
}
.btn.secondary {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.06);
  color: #ffd6ea;
}
.btn.tertiary {
  background: linear-gradient(90deg,#ff8abf,#ff629c);
}

/* cart section */
.section-title {
  text-align:center;
  font-size:22px;
  margin:22px 0 12px;
  color:var(--pink-1);
  font-weight:700;
}

.cart-bar-wrap {
  display:flex;
  justify-content:center;
  margin-bottom:14px;
}
.cart-bar {
  width:420px;
  max-width:95%;
  background: rgba(0,0,0,0.45);
  border-radius:14px;
  padding:12px 16px;
  color:#ffd6ea;
  text-align:left;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  border:1px solid rgba(255,255,255,0.03);
}

/* cart list (centered card) */
#cart {
  margin:0 auto 18px;
  width: 92%;
  max-width:700px;
  background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.5));
  padding:12px;
  border-radius:12px;
  color:#ffd6ea;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  border:1px solid rgba(255,255,255,0.03);
}

/* cart items */
#cart ul { list-style:none; padding:0; margin:0; }
#cart li {
  display:flex;
  gap:12px;
  align-items:center;
  justify-content:space-between;
  padding:10px 6px;
  border-bottom:1px dashed rgba(255,255,255,0.04);
}
.item-left { display:flex; gap:12px; align-items:center; flex:1; text-align:left; }
.item-left img { width:56px; height:48px; object-fit:cover; border-radius:8px; }
.item-name { font-weight:700; color:#ffd6ea; }
.item-price { font-size:0.9rem; color:#ffd6eaaa; }

/* qty controls */
.qty-controls {
  display:flex;
  align-items:center;
  gap:8px;
}
.qty-btn {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.06);
  color: #fff;
  padding:6px 10px;
  border-radius:8px;
  cursor:pointer;
  font-weight:700;
}
.qty-display { font-weight:700; min-width:26px; text-align:center; color:#ffd6ea; }

/* line total */
.line-total { min-width:84px; text-align:right; font-weight:700; color:#ffd6ea; }

/* grand total */
.cart-total {
  margin-top:12px;
  text-align:right;
  font-weight:800;
  font-size:1.05rem;
  color:#ffd6ea;
}

/* checkout form */
.checkout-box {
  max-width:460px;
  margin:16px auto 0;
  background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.6));
  padding:18px;
  border-radius:14px;
  box-shadow:0 16px 40px rgba(0,0,0,0.55);
  border:1px solid rgba(255,255,255,0.04);
}

.checkout-box input {
  width:100%;
  padding:12px 14px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.08);
  background: rgba(255,255,255,0.03);
  color:#ffd6ea;
  outline:none;
}

.checkout-box input::placeholder { color:#e6b9d0; }

/* account modal styles (simple override) */
.modal-flex { display:flex; align-items:center; justify-content:center; }
.modal-card {
  width:90%;
  max-width:480px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  padding:18px;
  border-radius:12px;
  color:#ffd6ea;
}

/* responsive */
@media(max-width:880px){
  .topbar { flex-direction:column; align-items:flex-start; gap:12px; }
  .divider { display:none; }
  .brand { font-size:28px; }
}
@media(max-width:560px){
  .product img { height:130px; }
  .header { font-size:28px; }
  .cart-bar { width: 95%; }
  .line-total { min-width:64px; }
}
</style>
</head>
<body>

<div class="container">

  <!-- NEW TOP BAR: brand on left, divider, controls on right -->
  <div class="topbar">
    <div style="display:flex; align-items:center; gap:12px;">
      <div class="brand">âœ¨ <span style="color:var(--pink-2)">PinkPetal.store</span> âœ¨</div>
    </div>

    <div style="display:flex; align-items:center; gap:16px;">
      <div class="divider" aria-hidden="true"></div>

      <div class="right-controls" role="region" aria-label="Account and cart controls">
        <button id="showLoginBtn" class="btn small-btn">Login / Sign up</button>
        <button id="showAccountBtn" class="btn small-btn" style="display:none;">My Account</button>
        <button id="logoutBtn" class="btn small-btn tertiary" style="display:none;">Logout</button>

        <div class="cart-mini" title="Cart items">
          <span style="font-size:16px;">ðŸ›’</span>
          <span id="cartCountMini">0</span>
        </div>
      </div>
    </div>
  </div>
  <!-- END TOP BAR -->

  <!-- Login / Register Modal -->
  <div id="accountModal" class="modal-flex" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:9999;">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="accountTitle">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="accountTitle" style="margin:0">Account</h3>
        <button id="closeAccountModal" style="background:transparent;border:none;color:#ffd6ea;font-size:18px;">âœ•</button>
      </div>

      <div id="authSection" style="margin-top:12px;">
        <div style="display:flex;gap:8px;margin-bottom:12px;">
          <button id="tabLogin" class="btn secondary">Login</button>
          <button id="tabRegister" class="btn secondary">Register</button>
        </div>

        <form id="loginForm" style="display:block;">
          <input name="email" placeholder="Email" required>
          <input name="password" type="password" placeholder="Password" required>
          <button class="btn" style="width:100%;">Login</button>
        </form>

        <form id="registerForm" style="display:none;">
          <input name="username" placeholder="Username" required>
          <input name="email" placeholder="Email" required>
          <input name="password" type="password" placeholder="Password" required>
          <button class="btn" style="width:100%;">Create account</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Account Dashboard Modal -->
  <div id="accountDashboard" class="modal-flex" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:9999;padding:20px;overflow:auto;">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="dashTitle" style="max-width:720px;max-height:90vh;overflow:auto;">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="dashTitle" style="margin:0">My Account</h3>
        <button id="closeAccountDash" style="background:transparent;border:none;color:#ffd6ea;font-size:18px;">âœ•</button>
      </div>

      <div style="margin-top:12px;">
        <h4>Profile</h4>
        <div id="profileSummary" style="margin-bottom:12px;"></div>

        <h4>Saved Addresses</h4>
        <div id="addressList" style="margin-bottom:12px;"></div>

        <form id="addAddressForm" style="margin-bottom:12px;">
          <input name="label" placeholder="Label (Home / Work)" required>
          <textarea name="address" placeholder="Full address" required style="width:100%;padding:8px;margin:6px 0;border-radius:6px;"></textarea>
          <input name="phone" placeholder="Phone" required>
          <button class="btn" style="width:100%;">Save address</button>
        </form>

        <h4>My Orders</h4>
        <div id="ordersList" style="margin-bottom:12px;"></div>
      </div>
    </div>
  </div>

  <!-- PRODUCTS -->
  <div id="product-list" class="products" aria-live="polite"></div>

  <!-- CART -->
  <div class="section-title">ðŸ›’ Your Cart</div>
  <div class="cart-bar-wrap"><div class="cart-bar"><strong>Items in cart:</strong> <span id="cartCount">0</span></div></div>
  <div id="cart" aria-label="Cart contents"></div>

  <!-- CHECKOUT -->
  <div class="section-title">ðŸ“¦ Checkout</div>
  <div class="checkout-box">
    <form id="checkout-form">
      <input name="name" placeholder="Full Name" required>
      <input name="address" placeholder="Address" required>
      <input name="email" placeholder="Email" required>
      <input name="phone" placeholder="Phone (optional)">
      <button type="submit" class="btn" style="width:100%;">Continue to Payment</button>
    </form>
  </div>

</div>

<!-- subtle decorative dots -->
<div style="position:fixed;inset:0;pointer-events:none;background-image:radial-gradient(rgba(0,0,0,0.35) 1px, transparent 1px);background-size: 60px 60px;opacity:0.12"></div>

<!-- ACCOUNT JS: handles register/login, addresses, orders -->
<script>
/* ---------- Simple client-side account system ----------
   Storage:
     pp_users -> array [{username,email,hash,addresses:[],orders:[]}]
     pp_current_user -> username (string)
   Note: Uses SHA-256 in-browser hashing. Not a replacement for server-side auth.
*/

// small helper: SHA-256 hex
async function sha256hex(str){
  const enc = new TextEncoder();
  const data = enc.encode(str);
  const hash = await crypto.subtle.digest('SHA-256', data);
  const bytes = new Uint8Array(hash);
  return Array.from(bytes).map(b => b.toString(16).padStart(2,'0')).join('');
}

// storage helpers
function loadUsers(){ return JSON.parse(localStorage.getItem('pp_users')||'[]'); }
function saveUsers(users){ localStorage.setItem('pp_users', JSON.stringify(users)); }
function setCurrentUser(username){ localStorage.setItem('pp_current_user', username); }
function getCurrentUser(){ return localStorage.getItem('pp_current_user') || null; }
function getUserObject(username){
  const u = loadUsers().find(x => x.username === username || x.email === username);
  return u || null;
}

// UI elements
const showLoginBtn = document.getElementById('showLoginBtn');
const showAccountBtn = document.getElementById('showAccountBtn');
const logoutBtn = document.getElementById('logoutBtn');
const accountModal = document.getElementById('accountModal');
const accountDashboard = document.getElementById('accountDashboard');

const tabLogin = document.getElementById('tabLogin');
const tabRegister = document.getElementById('tabRegister');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const closeAccountModal = document.getElementById('closeAccountModal');
const closeAccountDash = document.getElementById('closeAccountDash');

function refreshAccountUI(){
  const cur = getCurrentUser();
  if(cur){
    showLoginBtn.style.display = 'none';
    showAccountBtn.style.display = '';
    logoutBtn.style.display = '';
    showAccountBtn.textContent = 'My Account';
  } else {
    showLoginBtn.style.display = '';
    showAccountBtn.style.display = 'none';
    logoutBtn.style.display = 'none';
  }
}

// open account modal
showLoginBtn.addEventListener('click', ()=>{ accountModal.style.display='flex'; loginForm.style.display='block'; registerForm.style.display='none'; });
closeAccountModal.addEventListener('click', ()=>{ accountModal.style.display='none'; });

// tabs
tabLogin.addEventListener('click', ()=>{ loginForm.style.display='block'; registerForm.style.display='none'; });
tabRegister.addEventListener('click', ()=>{ loginForm.style.display='none'; registerForm.style.display='block'; });

// register
registerForm.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const username = registerForm.username.value.trim();
  const email = registerForm.email.value.trim().toLowerCase();
  const password = registerForm.password.value;
  if(!username || !email || !password){ alert('Please fill all fields'); return; }

  let users = loadUsers();
  if(users.find(u=>u.email===email || u.username===username)){ alert('User/email already exists'); return; }
  const hash = await sha256hex(password);
  const newUser = { username, email, hash, addresses: [], orders: [] };
  users.push(newUser);
  saveUsers(users);
  setCurrentUser(username);
  accountModal.style.display='none';
  refreshAccountUI();
  alert('Account created and logged in as ' + username);
  prefillCheckout();
});

// login
loginForm.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const email = loginForm.email.value.trim().toLowerCase();
  const password = loginForm.password.value;
  if(!email || !password){ alert('Please fill all fields'); return; }
  const users = loadUsers();
  const user = users.find(u=>u.email===email || u.username===email);
  if(!user){ alert('No user found'); return; }
  const hash = await sha256hex(password);
  if(hash !== user.hash){ alert('Wrong password'); return; }
  setCurrentUser(user.username);
  accountModal.style.display='none';
  refreshAccountUI();
  alert('Logged in as ' + user.username);
  prefillCheckout();
});

// logout
logoutBtn.addEventListener('click', ()=>{
  localStorage.removeItem('pp_current_user');
 
