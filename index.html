<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Handmade Shop</title>
<style>
body{
  font-family: Arial;
  background: pink;
  margin:0;
  padding:0;
}
.header{
  text-align:center;
  padding:20px;
  font-size:30px;
  color:white;
  text-shadow:0 0 10px #fff;
}
.products{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));
  gap:15px;
  padding:20px;
}
.product{
  background:white;
  padding:10px;
  border-radius:15px;
  box-shadow:0 0 10px #ff88cc;
  text-align:center;
}
.product img{
  width:100%;
  border-radius:10px;
}
.cart-btn{
  background:#ff44aa;
  color:white;
  padding:8px;
  border:none;
  border-radius:10px;
}
.glitter{
  position:fixed;
  width:5px;
  height:5px;
  background:white;
  border-radius:50%;
  animation: sparkle 2s infinite;
}
@keyframes sparkle{
  0% {opacity:0;}
  50% {opacity:1;}
  100% {opacity:0;}
}

/* small cart styling so it looks nicer */
#cart {
  max-width: 700px;
  margin: 10px auto;
  background: rgba(255,255,255,0.95);
  padding: 12px;
  border-radius: 10px;
  color: #111;
}
#cart ul { list-style: none; padding:0; margin:0; }
#cart li { display:flex; justify-content:space-between; padding:8px 6px; border-bottom:1px solid #eee; align-items:center; }
#cart .remove-btn { background:transparent; border:none; color:#d00; font-weight:700; cursor:pointer; padding:6px; }
#cart .qty { font-weight:600; color:#333; margin-left:8px; }
#cart .line-total { color:#555; font-weight:600; }
#cart .total { text-align:right; font-size:1.05rem; font-weight:700; margin-top:8px; }
</style>
</head>

<body>

<div class="header">âœ¨ My Handmade Shop âœ¨</div>

<div id="product-list" class="products"></div>

<h2 style="text-align:center">ðŸ›’ Your Cart</h2>
<div id="cart"></div>

<h2 style="text-align:center">ðŸ“¦ Checkout</h2>
<div style="padding:20px;">
<form id="checkout-form">
  <input name="name" placeholder="Full Name" required><br><br>
  <input name="address" placeholder="Address" required><br><br>
  <input name="email" placeholder="Email" required><br><br>
  <button type="submit" class="cart-btn">Continue to Payment</button>
</form>
</div>

<script>
// glitter animation
for(let i=0;i<40;i++){
  let g=document.createElement("div");
  g.className="glitter";
  g.style.left=Math.random()*100+"vw";
  g.style.top=Math.random()*100+"vh";
  g.style.animationDelay=Math.random()*2+"s";
  document.body.appendChild(g);
}

/* -----------------------
   PRODUCTS
   ----------------------- */
let products = JSON.parse(localStorage.getItem("products")) || [];

// If there are no products in storage (first time), optionally seed demo items.
// Remove or replace demo items if you want admin-only control.
if (!products || products.length === 0) {
  products = [
    { id: "p1", name: "Rosy Heart Trinket", price: 299, img: "https://images.unsplash.com/photo-1545235617-9465b5a5f02f?q=80&w=800&auto=format&fit=crop" },
    { id: "p2", name: "Pink Macrame", price: 499, img: "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?q=80&w=800&auto=format&fit=crop" },
    { id: "p3", name: "Glitter Soap", price: 199, img: "https://images.unsplash.com/photo-1585238342022-2c0e6b0a1d8b?q=80&w=800&auto=format&fit=crop" }
  ];
  // don't auto-save â€” leave admin to manage real products.
}

// display products
function renderProducts(){
  let list=document.getElementById("product-list");
  list.innerHTML="";
  products.forEach((p,i)=>{
    // ensure price is numeric
    const price = Number(p.price) || 0;
    list.innerHTML+=`
      <div class="product">
        <img src="${p.img}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>â‚¹${price}</p>
        <button class="cart-btn" onclick="addToCart(${i})">Add to cart</button>
      </div>`;
  })
}
renderProducts();

/* -----------------------
   CART (with quantities)
   ----------------------- */
// cart structure: [{id,name,price,qty,img}, ...]
let cart = JSON.parse(localStorage.getItem("cart")) || [];

// Save cart helper
function saveCart(){
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

// Add product to cart (increments qty if exists)
function addToCart(index){
  const p = products[index];
  if(!p) return;
  const price = Number(p.price) || 0;
  const id = p.id || ('prod_' + Math.random().toString(36).slice(2,9));
  const existing = cart.find(item => item.id === id);
  if(existing){
    existing.qty = (existing.qty || 1) + 1;
  } else {
    cart.push({ id, name: p.name, price: price, qty: 1, img: p.img });
  }
  saveCart();
  // small UX feedback
  // alert(`${p.name} added to cart`);
}

// Remove one qty or remove item completely
function removeFromCart(index){
  if(!cart[index]) return;
  if(cart[index].qty > 1){
    cart[index].qty--;
  } else {
    cart.splice(index,1);
  }
  saveCart();
}

// Render cart contents and compute total
function renderCart(){
  let c = document.getElementById("cart");
  c.innerHTML = "";
  if(cart.length === 0){
    c.innerHTML = '<div style="padding:12px; text-align:center; color:#333">Your cart is empty</div>';
    // update count if you use a cartCount UI elsewhere
    return;
  }
  let html = '<ul>';
  cart.forEach((it, i) => {
    const lineTotal = Number(it.price) * Number(it.qty);
    html += `<li>
      <div style="flex:1; text-align:left;">
        <div style="font-weight:700; color:#111;">${it.name} <span class="qty">x${it.qty}</span></div>
        <div style="font-size:0.95rem; color:#444;">â‚¹${it.price} each â€¢ <span class="line-total">â‚¹${lineTotal}</span></div>
      </div>
      <div>
        <button class="remove-btn" onclick="removeFromCart(${i})">âˆ’</button>
      </div>
    </li>`;
  });
  html += '</ul>';
  const total = cart.reduce((s, it) => s + (Number(it.price) * Number(it.qty)), 0);
  html += `<div class="total">Total: â‚¹${total}</div>`;
  c.innerHTML = html;
}

// initial render on load
renderCart();

/* -----------------------
   CHECKOUT
   ----------------------- */
document.getElementById("checkout-form").onsubmit = (e) => {
  e.preventDefault();

  if(cart.length === 0){
    alert("Your cart is empty.");
    return;
  }

  let data = {
    name: e.target.name.value,
    address: e.target.address.value,
    email: e.target.email.value,
    cart: cart
  };

  // store order summary for payment page
  localStorage.setItem("order", JSON.stringify(data));

  // redirect to payment page (you already created payment.html)
  window.location.href = "payment.html";
};
</script>
</body>
</html>
